{"config":{"indexing":"full","lang":["en"],"min_search_length":3,"prebuild_index":false,"separator":"[\\s\\-]+"},"docs":[{"location":"","text":"PR\u00c1CTICA 2.2: Autenticaci\u00f3n en Nginx Instalaci\u00f3n de paquetes necesarios Comprobamos que la herramienta openssl est\u00e1 instalada: En mi caso esta ven\u00eda instalada por defecto, si no lo estuviera solo habr\u00eda que instalarla Creaci\u00f3n de usuarios y contrase\u00f1as Creamos un archivo oculto \".htpasswd\" donde guardar usuarios y contrase\u00f1as, y a\u00f1adimos nuestro primer usuario \"manuel\": Y a continuaci\u00f3n a\u00f1adimos una contrase\u00f1a cifrada para este: He creado dos usuarios, y voy a comprobar si ambos han sido creados y con clave cifrada: Configurando el servidor Nginx para usar autenticaci\u00f3n b\u00e1sica Utilizaremos la directiva auth_basic dentro del location y le pondremos el nombre a nuestro dominio que ser\u00e1 mostrado al usuario al solicitar las credenciales. Por \u00faltimo, configuramos Nginx para que utilice el fichero que previamente hemos creado con la directiva auth_basic_user_file : Comprobaci\u00f3n 1 Comprueba desde tu m\u00e1quina f\u00edsica/anfitri\u00f3n que puedes acceder a http://nombre-sitio-web y que se te solicita autenticaci\u00f3n Comprobaci\u00f3n 2 Comprueba que si decides cancelar la autenticaci\u00f3n, se te negar\u00e1 el acceso al sitio con un error. \u00bfQu\u00e9 error es? Nos da error 401, que es un c\u00f3digo de estado HTTP que significa \"No autorizado\". Esto indica que la solicitud realizada por el cliente no tiene credenciales de autenticaci\u00f3n v\u00e1lidas o que las credenciales proporcionadas no tienen permiso para acceder al recurso solicitado. Tarea 1 Intenta entrar primero con un usuario err\u00f3neo y luego con otro correcto. Puedes ver todos los sucesos y registros en los logs access.log y error.log Adjunta una captura de pantalla de los logs donde se vea que intentas entrar primero con un usuario inv\u00e1lido y con otro v\u00e1lido. Indica d\u00f3nde podemos ver los errores de usuario inv\u00e1lido o no encontrado, as\u00ed como donde podemos ver el n\u00famero de error que os aparec\u00eda antes Registro de acceso: Registro de errores: Combinaci\u00f3n de la autenticaci\u00f3n b\u00e1sica con la restricci\u00f3n de acceso por IP Permitir o denegar acceso sobre una IP concreta (directivas allow y deny, respectivamente). Dentro del block server o archivo de configuraci\u00f3n del dominio web, que recordad est\u00e1 en el directorio sites-available: El acceso se garantizar\u00e1 ala IP 192.168.1.219/24, excluyendo a la direcci\u00f3n 192.168.1.220. La directiva deny all denega el acceso a todo el mundo. Combinar la restricci\u00f3n IP y la autenticaci\u00f3n HTTP con la directiva satisfy. Si establecemos el valor de la directiva a \u201call\u201d, el acceso se permite si el cliente satisface ambas condiciones (IP y usario v\u00e1lido). Si lo establecemos a \u201cany\u201d, el acceso se permite si se satisface al menos una de las dos condiciones. TAREAS TAREA 1 Configura Nginx para que no deje acceder con la IP de la m\u00e1quina anfitriona al directorio ra\u00edz de una de tus dos webs. Modifica su server block o archivo de configuraci\u00f3n. Comprueba como se deniega el acceso: - Muestra la p\u00e1gina de error en el navegador Muestra el mensaje de error de error.log Denegamos el acceso a nuestra ip: Comprobamos el navegador: Y por \u00faltimo el registro de error: TAREA 2 Configura Nginx para que desde tu m\u00e1quina anfitriona se tenga que tener tanto una IP v\u00e1lida como un usuario v\u00e1lido, ambas cosas a la vez, y comprueba que s\u00ed puede acceder sin problemas Permitimos acceso a nuestra ip y activamos la solicitud de autorizaci\u00f3n: E introducimos las credenciales en el navegador: CUESTIONES FINALES CUESTI\u00d3N 1 Supongamos que yo soy el cliente con la IP 172.1.10.15 e intento acceder al directorio web_muy_guay de mi sitio web, equivoc\u00e1ndome al poner el usuario y contrase\u00f1a. \u00bfPodr\u00e9 acceder?\u00bfPor qu\u00e9? No se podr\u00e1 acceder, ya que al haber configurado la opci\u00f3n \"satisfy all\", est\u00e1s exigiendo que se cumplan ambas condiciones: que la IP est\u00e9 permitida y que la autenticaci\u00f3n sea correcta. CUESTI\u00d3N 2 Supongamos que yo soy el cliente con la IP 172.1.10.15 e intento acceder al directorio web_muy_guay de mi sitio web, introduciendo correctamente usuari y contrase\u00f1a. \u00bfPodr\u00e9 acceder?\u00bfPor qu\u00e9? Si ingresas el usuario y la contrase\u00f1a correctos, podr\u00e1s acceder al sitio porque cumples con ambas condiciones: la autenticaci\u00f3n es v\u00e1lida y tu IP est\u00e1 autorizada. CUESTI\u00d3N 3 Supongamos que yo soy el cliente con la IP 172.1.10.15 e intento acceder al directorio web_muy_guay de mi sitio web, introduciendo correctamente usuario y contrase\u00f1a. \u00bfPodr\u00e9 acceder?\u00bfPor qu\u00e9? En este caso, con \"satisfy any\", aunque tu IP est\u00e9 bloqueada, no podr\u00e1s acceder a la web porque se est\u00e1 aplicando una restricci\u00f3n de IP que tiene prioridad. CUESTI\u00d3N 4 A lo mejor no sab\u00e9is que tengo una web para documentar todas mis excursiones espaciales con Jeff, es esta: Jeff Bezos y yo Supongamos que quiero restringir el acceso al directorio de proyectos porque es muy secreto, eso quiere decir a\u00f1adir autenticaci\u00f3n b\u00e1sica a la URL:Proyectos Completa la configuraci\u00f3n para conseguirlo: server { listen 80; listen [::]:80; root /var/www/freewebsitetemplates.com/preview/space-science; index index.html index.htm index.nginx-debian.html; server_name freewebsitetemplates.com www.freewebsitetemplates.com; location /proyectos { auth_basic \"Proyectos secretos\"; auth_basic_user_file /etc/nginx/.htpasswd; try_files $uri $uri/ =404; } }","title":"PR\u00c1CTICA 2.2: Autenticaci\u00f3n en Nginx"},{"location":"#practica-22-autenticacion-en-nginx","text":"","title":"PR\u00c1CTICA 2.2: Autenticaci\u00f3n en Nginx"},{"location":"#instalacion-de-paquetes-necesarios","text":"Comprobamos que la herramienta openssl est\u00e1 instalada: En mi caso esta ven\u00eda instalada por defecto, si no lo estuviera solo habr\u00eda que instalarla","title":"Instalaci\u00f3n de paquetes necesarios"},{"location":"#creacion-de-usuarios-y-contrasenas","text":"Creamos un archivo oculto \".htpasswd\" donde guardar usuarios y contrase\u00f1as, y a\u00f1adimos nuestro primer usuario \"manuel\": Y a continuaci\u00f3n a\u00f1adimos una contrase\u00f1a cifrada para este: He creado dos usuarios, y voy a comprobar si ambos han sido creados y con clave cifrada:","title":"Creaci\u00f3n de usuarios y contrase\u00f1as"},{"location":"#configurando-el-servidor-nginx-para-usar-autenticacion-basica","text":"Utilizaremos la directiva auth_basic dentro del location y le pondremos el nombre a nuestro dominio que ser\u00e1 mostrado al usuario al solicitar las credenciales. Por \u00faltimo, configuramos Nginx para que utilice el fichero que previamente hemos creado con la directiva auth_basic_user_file : Comprobaci\u00f3n 1 Comprueba desde tu m\u00e1quina f\u00edsica/anfitri\u00f3n que puedes acceder a http://nombre-sitio-web y que se te solicita autenticaci\u00f3n Comprobaci\u00f3n 2 Comprueba que si decides cancelar la autenticaci\u00f3n, se te negar\u00e1 el acceso al sitio con un error. \u00bfQu\u00e9 error es? Nos da error 401, que es un c\u00f3digo de estado HTTP que significa \"No autorizado\". Esto indica que la solicitud realizada por el cliente no tiene credenciales de autenticaci\u00f3n v\u00e1lidas o que las credenciales proporcionadas no tienen permiso para acceder al recurso solicitado.","title":"Configurando el servidor Nginx para usar autenticaci\u00f3n b\u00e1sica"},{"location":"#tarea-1","text":"Intenta entrar primero con un usuario err\u00f3neo y luego con otro correcto. Puedes ver todos los sucesos y registros en los logs access.log y error.log Adjunta una captura de pantalla de los logs donde se vea que intentas entrar primero con un usuario inv\u00e1lido y con otro v\u00e1lido. Indica d\u00f3nde podemos ver los errores de usuario inv\u00e1lido o no encontrado, as\u00ed como donde podemos ver el n\u00famero de error que os aparec\u00eda antes Registro de acceso: Registro de errores:","title":"Tarea 1"},{"location":"#combinacion-de-la-autenticacion-basica-con-la-restriccion-de-acceso-por-ip","text":"Permitir o denegar acceso sobre una IP concreta (directivas allow y deny, respectivamente). Dentro del block server o archivo de configuraci\u00f3n del dominio web, que recordad est\u00e1 en el directorio sites-available: El acceso se garantizar\u00e1 ala IP 192.168.1.219/24, excluyendo a la direcci\u00f3n 192.168.1.220. La directiva deny all denega el acceso a todo el mundo. Combinar la restricci\u00f3n IP y la autenticaci\u00f3n HTTP con la directiva satisfy. Si establecemos el valor de la directiva a \u201call\u201d, el acceso se permite si el cliente satisface ambas condiciones (IP y usario v\u00e1lido). Si lo establecemos a \u201cany\u201d, el acceso se permite si se satisface al menos una de las dos condiciones.","title":"Combinaci\u00f3n de la autenticaci\u00f3n b\u00e1sica con la restricci\u00f3n de acceso por IP"},{"location":"#tareas","text":"","title":"TAREAS"},{"location":"#tarea-1_1","text":"Configura Nginx para que no deje acceder con la IP de la m\u00e1quina anfitriona al directorio ra\u00edz de una de tus dos webs. Modifica su server block o archivo de configuraci\u00f3n. Comprueba como se deniega el acceso: - Muestra la p\u00e1gina de error en el navegador Muestra el mensaje de error de error.log Denegamos el acceso a nuestra ip: Comprobamos el navegador: Y por \u00faltimo el registro de error:","title":"TAREA 1"},{"location":"#tarea-2","text":"Configura Nginx para que desde tu m\u00e1quina anfitriona se tenga que tener tanto una IP v\u00e1lida como un usuario v\u00e1lido, ambas cosas a la vez, y comprueba que s\u00ed puede acceder sin problemas Permitimos acceso a nuestra ip y activamos la solicitud de autorizaci\u00f3n: E introducimos las credenciales en el navegador:","title":"TAREA 2"},{"location":"#cuestiones-finales","text":"","title":"CUESTIONES FINALES"},{"location":"#cuestion-1","text":"Supongamos que yo soy el cliente con la IP 172.1.10.15 e intento acceder al directorio web_muy_guay de mi sitio web, equivoc\u00e1ndome al poner el usuario y contrase\u00f1a. \u00bfPodr\u00e9 acceder?\u00bfPor qu\u00e9? No se podr\u00e1 acceder, ya que al haber configurado la opci\u00f3n \"satisfy all\", est\u00e1s exigiendo que se cumplan ambas condiciones: que la IP est\u00e9 permitida y que la autenticaci\u00f3n sea correcta.","title":"CUESTI\u00d3N 1"},{"location":"#cuestion-2","text":"Supongamos que yo soy el cliente con la IP 172.1.10.15 e intento acceder al directorio web_muy_guay de mi sitio web, introduciendo correctamente usuari y contrase\u00f1a. \u00bfPodr\u00e9 acceder?\u00bfPor qu\u00e9? Si ingresas el usuario y la contrase\u00f1a correctos, podr\u00e1s acceder al sitio porque cumples con ambas condiciones: la autenticaci\u00f3n es v\u00e1lida y tu IP est\u00e1 autorizada.","title":"CUESTI\u00d3N 2"},{"location":"#cuestion-3","text":"Supongamos que yo soy el cliente con la IP 172.1.10.15 e intento acceder al directorio web_muy_guay de mi sitio web, introduciendo correctamente usuario y contrase\u00f1a. \u00bfPodr\u00e9 acceder?\u00bfPor qu\u00e9? En este caso, con \"satisfy any\", aunque tu IP est\u00e9 bloqueada, no podr\u00e1s acceder a la web porque se est\u00e1 aplicando una restricci\u00f3n de IP que tiene prioridad.","title":"CUESTI\u00d3N 3"},{"location":"#cuestion-4","text":"A lo mejor no sab\u00e9is que tengo una web para documentar todas mis excursiones espaciales con Jeff, es esta: Jeff Bezos y yo Supongamos que quiero restringir el acceso al directorio de proyectos porque es muy secreto, eso quiere decir a\u00f1adir autenticaci\u00f3n b\u00e1sica a la URL:Proyectos Completa la configuraci\u00f3n para conseguirlo: server { listen 80; listen [::]:80; root /var/www/freewebsitetemplates.com/preview/space-science; index index.html index.htm index.nginx-debian.html; server_name freewebsitetemplates.com www.freewebsitetemplates.com; location /proyectos { auth_basic \"Proyectos secretos\"; auth_basic_user_file /etc/nginx/.htpasswd; try_files $uri $uri/ =404; } }","title":"CUESTI\u00d3N 4"}]}